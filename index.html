<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificador de Comidas da Noelinha</title>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState } = React;

/* ================= ICONOS ================= */

const Calendar = () => (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
    </svg>
);

const ShoppingCart = () => (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5"/>
    </svg>
);

const ChefHat = () => (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5"/>
    </svg>
);

const Trash2 = () => (
    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M19 7l-.867 12.142A2 2 0 0116.138 21"/>
    </svg>
);

const Lightbulb = () => (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M12 3v1m6.364 1.636l-.707.707"/>
    </svg>
);

const X = () => (
    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M6 18L18 6M6 6l12 12"/>
    </svg>
);

const Search = () => (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
              d="M21 21l-6-6"/>
    </svg>
);

/* ================= APP ================= */

const MealPlanner = () => {

    const API_KEY = "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";

    const [meals, setMeals] = useState({});
    const [shoppingList, setShoppingList] = useState([]);
    const [selectedMeal, setSelectedMeal] = useState(null);
    const [activeTab, setActiveTab] = useState('planner');
    const [isGenerating, setIsGenerating] = useState(false);
    const [searchQuery, setSearchQuery] = useState('');
    const [isSearching, setIsSearching] = useState(false);

      const recetasIniciales = {
                'Paella Valenciana': {
                    ingredientes: ['400g arroz', '300g pollo', '200g conejo', '100g judías verdes', '100g garrofón', 'Azafrán', 'Aceite de oliva', 'Sal'],
                    preparacion: '1. Sofreír el pollo y el conejo en la paella\n2. Añadir las judías verdes y el garrofón\n3. Añadir el arroz y rehogar\n4. Añadir agua caliente con azafrán\n5. Cocinar a fuego medio-alto durante 18-20 minutos'
                },
                'Tortilla Española': {
                    ingredientes: ['6 huevos', '4 patatas grandes', '1 cebolla', 'Aceite de oliva', 'Sal'],
                    preparacion: '1. Pelar y cortar las patatas en rodajas finas\n2. Freír las patatas y la cebolla en abundante aceite\n3. Batir los huevos y mezclar con las patatas escurridas\n4. Cuajar en la sartén por ambos lados\n5. Servir caliente o fría'
                },
                'Gazpacho Andaluz': {
                    ingredientes: ['1kg tomates maduros', '1 pimiento verde', '1 pepino', '1 diente de ajo', 'Pan del día anterior', 'Vinagre', 'Aceite de oliva', 'Sal'],
                    preparacion: '1. Lavar y trocear las verduras\n2. Remojar el pan en agua\n3. Triturar todo junto con aceite, vinagre y sal\n4. Pasar por el colador\n5. Enfriar en la nevera y servir bien frío'
                },
                'Cocido Madrileño': {
                    ingredientes: ['400g garbanzos', '300g morcillo de ternera', '200g tocino', '1 hueso de jamón', '2 patatas', '2 zanahorias', 'Repollo', 'Fideos'],
                    preparacion: '1. Poner los garbanzos en remojo la noche anterior\n2. Cocer los garbanzos con las carnes y el hueso\n3. Añadir las verduras cuando los garbanzos estén tiernos\n4. Separar el caldo para la sopa de fideos\n5. Servir primero la sopa, luego los garbanzos y por último la carne'
                },
                'Pulpo a la Gallega': {
                    ingredientes: ['1 pulpo (1-1.5kg)', 'Patatas', 'Pimentón dulce y picante', 'Aceite de oliva virgen extra', 'Sal gorda'],
                    preparacion: '1. Cocer el pulpo en agua hirviendo (asustarlo 3 veces)\n2. Cocinar 40-50 minutos hasta que esté tierno\n3. Cocer las patatas en el mismo agua\n4. Cortar el pulpo en rodajas y las patatas en cachelos\n5. Espolvorear con pimentón y aceite de oliva'
                }
            };

    const [recipes, setRecipes] = useState(recetasIniciales);

    const diasSemana = ["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"];
    const tiposComida = ["Desayuno","Comida","Cena"];

    /* ========== FUNCIONES IA ========== */

    const generarIdeas = async () => {
        setIsGenerating(true);
        try {
            const res = await fetch("https://api.anthropic.com/v1/messages", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "x-api-key": API_KEY,
                    "anthropic-version": "2023-06-01"
                },
                body: JSON.stringify({
                    model: "claude-sonnet-4-20250514",
                    max_tokens: 600,
                    messages: [{ role: "user", content: "Dame 5 ideas de recetas españolas." }]
                })
            });

            const data = await res.json();
            alert("Ideas generadas correctamente (ver consola)");
            console.log(data);
        } catch (e) {
            alert("Error al generar ideas");
        }
        setIsGenerating(false);
    };

    const buscarReceta = async () => {
        if (!searchQuery.trim()) {
            alert("Escribe una receta");
            return;
        }

        setIsSearching(true);
        try {
            const res = await fetch("https://api.anthropic.com/v1/messages", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "x-api-key": API_KEY,
                    "anthropic-version": "2023-06-01"
                },
                body: JSON.stringify({
                    model: "claude-sonnet-4-20250514",
                    max_tokens: 600,
                    messages: [{ role: "user", content: `Dame la receta de ${searchQuery}` }]
                })
            });

            const data = await res.json();
            alert("Receta obtenida (ver consola)");
            console.log(data);
        } catch (e) {
            alert("Error al buscar receta");
        }
        setIsSearching(false);
    };

    return (
        <div className="min-h-screen bg-red-50 p-6">
            <h1 className="text-3xl font-bold mb-4 text-center">
                Planificador de Comidas da Noelinha
            </h1>

            <div className="flex gap-2 justify-center mb-6">
                <button onClick={() => setActiveTab("planner")}>Planificador</button>
                <button onClick={() => setActiveTab("recipes")}>Recetas</button>
            </div>

            {activeTab === "planner" && (
                <button onClick={generarIdeas} disabled={isGenerating}>
                    Generar Ideas con IA
                </button>
            )}

            {activeTab === "recipes" && (
                <div className="flex gap-2">
                    <input
                        value={searchQuery}
                        onChange={e => setSearchQuery(e.target.value)}
                        placeholder="Buscar receta"
                    />
                    <button onClick={buscarReceta} disabled={isSearching}>
                        Buscar
                    </button>
                </div>
            )}
        </div>
    );
};

/* ========== REACT 18 ========== */
const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(<MealPlanner />);
</script>
</body>
</html>
